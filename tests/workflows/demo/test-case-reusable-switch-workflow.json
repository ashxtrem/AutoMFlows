{
  "nodes": [
    {
      "id": "start-1",
      "type": "start",
      "position": {
        "x": 100,
        "y": 500
      },
      "data": {
        "type": "start",
        "label": "Start"
      }
    },
    {
      "id": "reusable-visit-page",
      "type": "reusable.reusable",
      "position": {
        "x": 100,
        "y": 100
      },
      "data": {
        "type": "reusable.reusable",
        "label": "Reusable: visit_page",
        "contextName": "visit_page"
      }
    },
    {
      "id": "openBrowser-visit",
      "type": "openBrowser",
      "position": {
        "x": 350,
        "y": 100
      },
      "data": {
        "type": "openBrowser",
        "label": "Open Browser",
        "headless": false,
        "viewportWidth": 1280,
        "viewportHeight": 720
      }
    },
    {
      "id": "navigate-todolist",
      "type": "navigation",
      "position": {
        "x": 600,
        "y": 100
      },
      "data": {
        "type": "navigation",
        "label": "Navigate to Todo List",
        "action": "navigate",
        "url": "https://todolist.james.am",
        "timeout": 30000,
        "waitUntil": "networkidle"
      }
    },
    {
      "id": "verify-homepage",
      "type": "verify",
      "position": {
        "x": 850,
        "y": 100
      },
      "data": {
        "type": "verify",
        "label": "Verify Home Page",
        "domain": "browser",
        "verificationType": "text",
        "selector": "h1",
        "selectorType": "css",
        "expectedText": "To Do List",
        "matchType": "equals",
        "timeout": 30000
      }
    },
    {
      "id": "end-visit-page",
      "type": "reusable.end",
      "position": {
        "x": 1100,
        "y": 100
      },
      "data": {
        "type": "reusable.end",
        "label": "End"
      }
    },
    {
      "id": "reusable-add-todo",
      "type": "reusable.reusable",
      "position": {
        "x": 100,
        "y": 250
      },
      "data": {
        "type": "reusable.reusable",
        "label": "Reusable: add_todo",
        "contextName": "add_todo"
      }
    },
    {
      "id": "wait-newtodo",
      "type": "wait",
      "position": {
        "x": 350,
        "y": 250
      },
      "data": {
        "type": "wait",
        "label": "Wait for New Todo Input",
        "waitType": "selector",
        "value": "[ng-model=\"newTodo\"]",
        "selectorType": "css",
        "timeout": 30000
      }
    },
    {
      "id": "javascript-get-todo-text",
      "type": "javascriptCode",
      "position": {
        "x": 600,
        "y": 250
      },
      "data": {
        "type": "javascriptCode",
        "label": "Get Todo Text and Type",
        "code": "const todoText = context.getData('todo_text');\nif (!todoText) {\n  throw new Error('todo_text variable not found in context');\n}\nconst page = context.page;\nif (!page) {\n  throw new Error('Page not available');\n}\nawait page.fill('[ng-model=\"newTodo\"]', todoText, { timeout: 30000 });\nawait page.press('[ng-model=\"newTodo\"]', 'Enter');\nconsole.log('Typed and submitted todo text:', todoText);"
      }
    },
    {
      "id": "end-add-todo",
      "type": "reusable.end",
      "position": {
        "x": 850,
        "y": 250
      },
      "data": {
        "type": "reusable.end",
        "label": "End"
      }
    },
    {
      "id": "run-visit-page",
      "type": "reusable.runReusable",
      "position": {
        "x": 350,
        "y": 500
      },
      "data": {
        "type": "reusable.runReusable",
        "label": "Run Reusable: visit_page",
        "contextName": "visit_page"
      }
    },
    {
      "id": "javascript-set-add-multiple",
      "type": "javascriptCode",
      "position": {
        "x": 600,
        "y": 500
      },
      "data": {
        "type": "javascriptCode",
        "label": "Set Add Multiple Flag",
        "code": "// Set a flag to determine if we should add multiple todos\nconst shouldAddMultiple = Math.random() > 0.5;\ncontext.setData('add_multiple', shouldAddMultiple);\nconsole.log('Should add multiple todos:', shouldAddMultiple);"
      }
    },
    {
      "id": "switch-add-multiple",
      "type": "switch.switch",
      "position": {
        "x": 850,
        "y": 500
      },
      "data": {
        "type": "switch.switch",
        "label": "Switch: Add Multiple?",
        "cases": [
          {
            "id": "case-add-multiple",
            "label": "Add Multiple",
            "condition": {
              "type": "javascript",
              "javascriptExpression": "context.getData('add_multiple') === true"
            }
          }
        ],
        "defaultCase": {
          "label": "Add Single"
        }
      }
    },
    {
      "id": "javascript-gen-todo-1",
      "type": "javascriptCode",
      "position": {
        "x": 1100,
        "y": 400
      },
      "data": {
        "type": "javascriptCode",
        "label": "Generate First Todo Text",
        "code": "const randomText = 'Todo ' + Math.random().toString(36).substring(2, 15);\ncontext.setData('todo_text', randomText);\nconsole.log('Generated first todo_text:', randomText);"
      }
    },
    {
      "id": "run-add-todo-1",
      "type": "reusable.runReusable",
      "position": {
        "x": 1350,
        "y": 400
      },
      "data": {
        "type": "reusable.runReusable",
        "label": "Run Reusable: add_todo (1st)",
        "contextName": "add_todo"
      }
    },
    {
      "id": "javascript-gen-todo-2",
      "type": "javascriptCode",
      "position": {
        "x": 1600,
        "y": 400
      },
      "data": {
        "type": "javascriptCode",
        "label": "Generate Second Todo Text",
        "code": "const randomText = 'Second Todo ' + Math.random().toString(36).substring(2, 15);\ncontext.setData('todo_text', randomText);\nconsole.log('Generated second todo_text:', randomText);"
      }
    },
    {
      "id": "run-add-todo-2",
      "type": "reusable.runReusable",
      "position": {
        "x": 1850,
        "y": 400
      },
      "data": {
        "type": "reusable.runReusable",
        "label": "Run Reusable: add_todo (2nd)",
        "contextName": "add_todo"
      }
    },
    {
      "id": "javascript-gen-todo-single",
      "type": "javascriptCode",
      "position": {
        "x": 1100,
        "y": 600
      },
      "data": {
        "type": "javascriptCode",
        "label": "Generate Single Todo Text",
        "code": "const randomText = 'Single Todo ' + Math.random().toString(36).substring(2, 15);\ncontext.setData('todo_text', randomText);\nconsole.log('Generated single todo_text:', randomText);"
      }
    },
    {
      "id": "run-add-todo-single",
      "type": "reusable.runReusable",
      "position": {
        "x": 1350,
        "y": 600
      },
      "data": {
        "type": "reusable.runReusable",
        "label": "Run Reusable: add_todo (Single)",
        "contextName": "add_todo"
      }
    }
  ],
  "edges": [
    {
      "id": "edge-start-run-visit-page",
      "source": "start-1",
      "target": "run-visit-page",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-reusable-visit-openBrowser",
      "source": "reusable-visit-page",
      "target": "openBrowser-visit",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-openBrowser-navigate",
      "source": "openBrowser-visit",
      "target": "navigate-todolist",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-navigate-verify",
      "source": "navigate-todolist",
      "target": "verify-homepage",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-verify-end-visit",
      "source": "verify-homepage",
      "target": "end-visit-page",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-reusable-add-wait",
      "source": "reusable-add-todo",
      "target": "wait-newtodo",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-wait-javascript-todo",
      "source": "wait-newtodo",
      "target": "javascript-get-todo-text",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-javascript-todo-end-add",
      "source": "javascript-get-todo-text",
      "target": "end-add-todo",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-run-visit-javascript-set",
      "source": "run-visit-page",
      "target": "javascript-set-add-multiple",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-javascript-set-switch-input",
      "source": "javascript-set-add-multiple",
      "target": "switch-add-multiple",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "edge-javascript-set-switch-driver",
      "source": "run-visit-page",
      "target": "switch-add-multiple",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-switch-javascript-1-case",
      "source": "switch-add-multiple",
      "target": "javascript-gen-todo-1",
      "sourceHandle": "case-add-multiple",
      "targetHandle": "input"
    },
    {
      "id": "edge-switch-javascript-1-driver",
      "source": "run-visit-page",
      "target": "javascript-gen-todo-1",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-javascript-1-run-add-1",
      "source": "javascript-gen-todo-1",
      "target": "run-add-todo-1",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-run-add-1-javascript-2",
      "source": "run-add-todo-1",
      "target": "javascript-gen-todo-2",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-javascript-2-run-add-2",
      "source": "javascript-gen-todo-2",
      "target": "run-add-todo-2",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-switch-javascript-single-default",
      "source": "switch-add-multiple",
      "target": "javascript-gen-todo-single",
      "sourceHandle": "default",
      "targetHandle": "input"
    },
    {
      "id": "edge-switch-javascript-single-driver",
      "source": "run-visit-page",
      "target": "javascript-gen-todo-single",
      "sourceHandle": "output",
      "targetHandle": "driver"
    },
    {
      "id": "edge-javascript-single-run-add-single",
      "source": "javascript-gen-todo-single",
      "target": "run-add-todo-single",
      "sourceHandle": "output",
      "targetHandle": "driver"
    }
  ]
}
